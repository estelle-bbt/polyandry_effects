model_ss_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + contact + (1|session), family = "binomial")
model_ss_q_id_3a <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + contact + (1|session), family = "binomial")
model_ss_q_id_4 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ttt + contact + (1|session), family = "binomial")
model_ss_q_id_5 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + contact + (1|session), family = "binomial")
model_ss_q_id_6 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + (1|session), family = "binomial")
lrt_interoms_ss_q <- anova(model_ss_q_id_0, model_ss_q_id_1) |> as.data.frame() # ratio_q * ttt
lrt_intercontact_ss_q <- anova(model_ss_q_id_0, model_ss_q_id_1) |> as.data.frame() # contact * ttt
lrt_q_ss_q <- anova(model_ss_q_id_3a, model_ss_q_id_4) |> as.data.frame() # ratio_q
lrt_ttt_ss_q <-anova(model_ss_q_id_3, model_ss_q_id_5) |> as.data.frame() # ttt
lrt_contact_ss_q <-anova(model_ss_q_id_3, model_ss_q_id_6) |> as.data.frame() # contact
lrt_ss_q <- lrt_interoms_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_intercontact_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "intercontact", .before = 1)) |>
bind_rows(lrt_q_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
bind_rows(lrt_contact_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "contact", .before = 1)) |>
mutate(method = method_name,
proxy = "ss",
response = "ratio_q", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
estimate_low_ss_q <- summary(model_ss_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
estimate_medium_ss_q <- summary(model_ss_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
estimate_high_ss_q <- summary(model_ss_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "high", .before = 1)
estimate_ss_q <- estimate_low_ss_q |>
bind_rows(estimate_medium_ss_q) |>
bind_rows(estimate_high_ss_q) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "q", .before = 1)
### germ ----
model_germ_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
model_germ_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + contact * ttt + (1|session), family = "binomial")
model_germ_q_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + contact + ttt + (1|session), family = "binomial")
model_germ_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + contact + (1|session), family = "binomial")
model_germ_q_id_3a <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + contact + (1|session), family = "binomial")
model_germ_q_id_4 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ttt + contact + (1|session), family = "binomial")
model_germ_q_id_5 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + contact + (1|session), family = "binomial")
model_germ_q_id_6 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + (1|session), family = "binomial")
lrt_interoms_germ_q <- anova(model_germ_q_id_0, model_germ_q_id_1) |> as.data.frame() # ratio_q * ttt
lrt_intercontact_germ_q <- anova(model_germ_q_id_0, model_germ_q_id_1) |> as.data.frame() # contact * ttt
lrt_q_germ_q <- anova(model_germ_q_id_3a, model_germ_q_id_4) |> as.data.frame() # ratio_q
lrt_ttt_germ_q <-anova(model_germ_q_id_3, model_germ_q_id_5) |> as.data.frame() # ttt
lrt_contact_germ_q <-anova(model_germ_q_id_3, model_germ_q_id_6) |> as.data.frame() # contact
lrt_germ_q <- lrt_interoms_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_intercontact_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "intercontact", .before = 1)) |>
bind_rows(lrt_q_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
bind_rows(lrt_contact_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "contact", .before = 1)) |>
mutate(method = method_name,proxy = "germ",
response = "ratio_q",
.before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_germ_q_id_best <-lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
estimate_low_germ_q <- summary(model_germ_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
estimate_medium_germ_q <- summary(model_germ_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + contact * ttt + (1|session), family = "binomial")
estimate_high_germ_q <- summary(model_germ_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "high", .before = 1)
estimate_germ_q <- estimate_low_germ_q |>
bind_rows(estimate_medium_germ_q) |>
bind_rows(estimate_high_germ_q) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "q", .before = 1)
### weight ----
model_weight_q_id_0 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + contact * ttt + (1|session))
model_weight_q_id_1 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + ttt + contact * ttt + (1|session))
model_weight_q_id_2 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + contact + ttt + (1|session))
model_weight_q_id_3 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + ttt + contact + (1|session))
model_weight_q_id_3a <- lme4::lmer(data = data_final_id |> filter(!(is.na(ratio_q))), mean_seed_weight ~ ratio_q + ttt + contact + (1|session))
model_weight_q_id_4 <- lme4::lmer(data = data_final_id |> filter(!(is.na(ratio_q))), mean_seed_weight ~ ttt + contact + (1|session))
model_weight_q_id_5 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + contact + (1|session))
model_weight_q_id_6 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + ttt + (1|session))
lrt_interoms_weight_q <- anova(model_weight_q_id_0, model_weight_q_id_1) |> as.data.frame() # ratio_q * ttt
lrt_intercontact_weight_q <- anova(model_weight_q_id_0, model_weight_q_id_1) |> as.data.frame() # contact * ttt
lrt_q_weight_q <- anova(model_weight_q_id_3a, model_weight_q_id_4) |> as.data.frame() # ratio_q
lrt_ttt_weight_q <-anova(model_weight_q_id_3, model_weight_q_id_5) |> as.data.frame() # ttt
lrt_contact_weight_q <-anova(model_weight_q_id_3, model_weight_q_id_6) |> as.data.frame() # contact
lrt_weight_q <- lrt_interoms_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_intercontact_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "intercontact", .before = 1)) |>
bind_rows(lrt_q_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
bind_rows(lrt_contact_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "contact", .before = 1)) |>
mutate(method = method_name,proxy = "weight",
response = "ratio_q",
.before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_weight_q_id_best <-lmerTest::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + contact * ttt + (1|session))
estimate_low_weight_q <- summary(model_weight_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_weight_q_id_best <- lmerTest::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + contact * ttt + (1|session))
estimate_medium_weight_q <- summary(model_weight_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_weight_q_id_best <- lmerTest::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + contact * ttt + (1|session))
estimate_high_weight_q <- summary(model_weight_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname %in% c("ratio_q","contact")) |> mutate(ttt = "high", .before = 1)
estimate_weight_q <- estimate_low_weight_q |>
bind_rows(estimate_medium_weight_q) |>
bind_rows(estimate_high_weight_q) |>
rename(pvalue = "Pr(>|t|)") |>
mutate(method = method_name,
proxy = "q", .before = 1)
lrt_table <- lrt_q_oms |>
bind_rows(lrt_ab_oms) |>
bind_rows(lrt_ss_oms) |>
bind_rows(lrt_germ_oms) |>
bind_rows(lrt_weight_oms) |>
bind_rows(lrt_ab_q) |>
bind_rows(lrt_ss_q) |>
bind_rows(lrt_germ_q) |>
bind_rows(lrt_weight_q) |>
rename(chisq = Chisq,
df = Df,
pvalue = "Pr(>Chisq)")
estimate_table <- estimate_q_oms |>
bind_rows(estimate_ab_oms) |>
bind_rows(estimate_ss_oms) |>
bind_rows(estimate_germ_oms) |>
bind_rows(estimate_weight_oms) |>
bind_rows(estimate_ab_q) |>
bind_rows(estimate_ss_q) |>
bind_rows(estimate_germ_q) |>
bind_rows(estimate_weight_q) |>
select(-c("t value","z value")) |>
rename(estimate = Estimate,
se = "Std. Error")
}else{
method_name <- "wo_contact"
# without contact ----
## effect of oms on q ratio ----
model_q_oms_id_0 <- lme4::lmer(data = data_final_id, ratio_q ~ oms * ttt + (1|session))
model_q_oms_id_1 <- lme4::lmer(data = data_final_id, ratio_q ~ oms + ttt + (1|session))
model_q_oms_id_2 <- lme4::lmer(data = data_final_id, ratio_q ~ ttt + (1|session))
model_q_oms_id_3 <- lme4::lmer(data = data_final_id, ratio_q ~ oms + (1|session))
lrt_interoms_q_oms <- anova(model_q_oms_id_0, model_q_oms_id_1) |> as.data.frame() # ns oms * ttt
lrt_oms_q_oms <- anova(model_q_oms_id_1, model_q_oms_id_2) |> as.data.frame() # marg sin oms
lrt_ttt_q_oms <-anova(model_q_oms_id_1, model_q_oms_id_3) |> as.data.frame() # ns ttt
lrt_q_oms <- lrt_interoms_q_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interoms", .before = 1) |>
bind_rows(lrt_oms_q_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "oms", .before = 1)) |>
bind_rows(lrt_ttt_q_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "q",
response = "oms", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_q_oms_id_best <- lmerTest::lmer(data = data_final_id, ratio_q ~ oms * ttt + (1|session))
estimate_low_q_oms <- summary(model_q_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_q_oms_id_best <- lmerTest::lmer(data = data_final_id, ratio_q ~ oms * ttt + (1|session))
estimate_medium_q_oms <- summary(model_q_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_q_oms_id_best <- lmerTest::lmer(data = data_final_id, ratio_q ~ oms * ttt + (1|session))
estimate_high_q_oms <- summary(model_q_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "high", .before = 1)
estimate_q_oms <- estimate_low_q_oms |>
bind_rows(estimate_medium_q_oms) |>
bind_rows(estimate_high_q_oms) |>
rename(pvalue = "Pr(>|t|)") |>
mutate(method = method_name,
proxy = "q",
response = "oms", .before = 1)
## effect of oms on rs proxies ----
### aborted ----
model_ab_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
model_ab_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + ttt + (1|session), family = "binomial")
model_ab_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + (1|session), family = "binomial")
lrt_interoms_ab_oms <- anova(model_ab_oms_id_0, model_ab_oms_id_1) |> as.data.frame() # ns oms * ttt
lrt_oms_ab_oms <- anova(model_ab_oms_id_1, model_ab_oms_id_2) |> as.data.frame() # marg sin oms
lrt_ttt_ab_oms <-anova(model_ab_oms_id_1, model_ab_oms_id_3) |> as.data.frame() # ns ttt
lrt_ab_oms <- lrt_interoms_ab_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interoms", .before = 1) |>
bind_rows(lrt_oms_ab_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "oms", .before = 1)) |>
bind_rows(lrt_ttt_ab_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "ab",
response = "oms", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
estimate_low_ab_oms <- summary(model_ab_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
estimate_medium_ab_oms <- summary(model_ab_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
estimate_high_ab_oms <- summary(model_ab_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "high", .before = 1)
estimate_ab_oms <- estimate_low_ab_oms |>
bind_rows(estimate_medium_ab_oms) |>
bind_rows(estimate_high_ab_oms) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "ab",
response = "oms", .before = 1)
### seed-set ----
model_ss_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
model_ss_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms + ttt + (1|session), family = "binomial")
model_ss_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ttt + (1|session), family = "binomial")
model_ss_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms + (1|session), family = "binomial")
lrt_interoms_ss_oms <- anova(model_ss_oms_id_0, model_ss_oms_id_1) |> as.data.frame() # ns oms * ttt
lrt_oms_ss_oms <- anova(model_ss_oms_id_1, model_ss_oms_id_2) |> as.data.frame() # marg sin oms
lrt_ttt_ss_oms <-anova(model_ss_oms_id_1, model_ss_oms_id_3) |> as.data.frame() # ns ttt
lrt_ss_oms <- lrt_interoms_ss_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interoms", .before = 1) |>
bind_rows(lrt_oms_ss_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "oms", .before = 1)) |>
bind_rows(lrt_ttt_ss_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "ss",
response = "oms", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ss_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
estimate_low_ss_oms <- summary(model_ss_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ss_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
estimate_medium_ss_oms <- summary(model_ss_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ss_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
estimate_high_ss_oms <- summary(model_ss_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "high", .before = 1)
estimate_ss_oms <- estimate_low_ss_oms |>
bind_rows(estimate_medium_ss_oms) |>
bind_rows(estimate_high_ss_oms) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "ss",
response = "oms", .before = 1)
### germ ----
model_germ_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
model_germ_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms + ttt + (1|session), family = "binomial")
model_germ_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ttt + (1|session), family = "binomial")
model_germ_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms + (1|session), family = "binomial")
lrt_interoms_germ_oms <- anova(model_germ_oms_id_0, model_germ_oms_id_1) |> as.data.frame() # ns oms * ttt
lrt_oms_germ_oms <- anova(model_germ_oms_id_1, model_germ_oms_id_2) |> as.data.frame() # marg sin oms
lrt_ttt_germ_oms <-anova(model_germ_oms_id_1, model_germ_oms_id_3) |> as.data.frame() # ns ttt
lrt_germ_oms <- lrt_interoms_germ_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interoms", .before = 1) |>
bind_rows(lrt_oms_germ_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "oms", .before = 1)) |>
bind_rows(lrt_ttt_germ_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "germ",
response = "oms", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
estimate_low_germ_oms <- summary(model_germ_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
estimate_medium_germ_oms <- summary(model_germ_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
estimate_high_germ_oms <- summary(model_germ_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "high", .before = 1)
estimate_germ_oms <- estimate_low_germ_oms |>
bind_rows(estimate_medium_germ_oms) |>
bind_rows(estimate_high_germ_oms) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "germ",
response = "oms", .before = 1)
### weight ----
model_weight_oms_id_0 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ oms * ttt + (1|session))
model_weight_oms_id_1 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ oms + ttt + (1|session))
model_weight_oms_id_2 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ttt + (1|session))
model_weight_oms_id_3 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ oms + (1|session))
lrt_interoms_weight_oms <- anova(model_weight_oms_id_0, model_weight_oms_id_1) |> as.data.frame() # ns oms * ttt
lrt_oms_weight_oms <- anova(model_weight_oms_id_1, model_weight_oms_id_2) |> as.data.frame() # marg sin oms
lrt_ttt_weight_oms <-anova(model_weight_oms_id_1, model_weight_oms_id_3) |> as.data.frame() # ns ttt
lrt_weight_oms <- lrt_interoms_weight_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interoms", .before = 1) |>
bind_rows(lrt_oms_weight_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "oms", .before = 1)) |>
bind_rows(lrt_ttt_weight_oms |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "weight",
response = "oms", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_weight_oms_id_best <-  lmerTest::lmer(data = data_final_id, mean_seed_weight ~ oms * ttt + (1|session))
estimate_low_weight_oms <- summary(model_weight_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_weight_oms_id_best <-  lmerTest::lmer(data = data_final_id, mean_seed_weight ~ oms * ttt + (1|session))
estimate_medium_weight_oms <- summary(model_weight_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_weight_oms_id_best <-  lmerTest::lmer(data = data_final_id, mean_seed_weight ~ oms * ttt + (1|session))
estimate_high_weight_oms <- summary(model_weight_oms_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "oms") |> mutate(ttt = "high", .before = 1)
estimate_weight_oms <- estimate_low_weight_oms |>
bind_rows(estimate_medium_weight_oms) |>
bind_rows(estimate_high_weight_oms) |>
rename(pvalue = "Pr(>|t|)") |>
mutate(method = method_name,
proxy = "weight",
response = "oms", .before = 1)
## effect of ratio_q on rs proxies ----
### aborted ----
model_ab_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
model_ab_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ab_q_id_1b <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)) , cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ab_q_id_2 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)) , cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + (1|session), family = "binomial")
lrt_interoms_ab_q <- anova(model_ab_q_id_0, model_ab_q_id_1) |> as.data.frame() # ns ratio_q * ttt
lrt_q_ab_q <- anova(model_ab_q_id_1b, model_ab_q_id_2) |> as.data.frame() # marg sin ratio_q
lrt_ttt_ab_q <-anova(model_ab_q_id_1, model_ab_q_id_3) |> as.data.frame() # ns ttt
lrt_ab_q <- lrt_interoms_ab_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_q_ab_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_ab_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "ab",
response = "ratio_q", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ab_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_low_ab_q <- summary(model_ab_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ab_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_medium_ab_q <- summary(model_ab_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ab_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_high_ab_q <- summary(model_ab_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "high", .before = 1)
estimate_ab_q <- estimate_low_ab_q |>
bind_rows(estimate_medium_ab_q) |>
bind_rows(estimate_high_ab_q) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "ab",
response = "ratio_q", .before = 1)
### seed-set ----
model_ss_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
model_ss_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ss_q_id_1b <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ss_q_id_2 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ttt + (1|session), family = "binomial")
model_ss_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + (1|session), family = "binomial")
lrt_interoms_ss_q <- anova(model_ss_q_id_0, model_ss_q_id_1) |> as.data.frame() # ns ratio_q * ttt
lrt_q_ss_q <- anova(model_ss_q_id_1b, model_ss_q_id_2) |> as.data.frame() # marg sin ratio_q
lrt_ttt_ss_q <-anova(model_ss_q_id_1, model_ss_q_id_3) |> as.data.frame() # ns ttt
lrt_ss_q <- lrt_interoms_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_q_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_ss_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "ss",
response = "ratio_q", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_low_ss_q <- summary(model_ss_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_medium_ss_q <- summary(model_ss_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_high_ss_q <- summary(model_ss_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "high", .before = 1)
estimate_ss_q <- estimate_low_ss_q |>
bind_rows(estimate_medium_ss_q) |>
bind_rows(estimate_high_ss_q) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "ss",
response = "ratio_q", .before = 1)
### germ ----
model_germ_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
model_germ_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + (1|session), family = "binomial")
model_germ_q_id_1b <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + (1|session), family = "binomial")
model_germ_q_id_2 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ttt + (1|session), family = "binomial")
model_germ_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + (1|session), family = "binomial")
lrt_interoms_germ_q <- anova(model_germ_q_id_0, model_germ_q_id_1) |> as.data.frame() # ns ratio_q * ttt
lrt_q_germ_q <- anova(model_germ_q_id_1b, model_germ_q_id_2) |> as.data.frame() # marg sin ratio_q
lrt_ttt_germ_q <-anova(model_germ_q_id_1, model_germ_q_id_3) |> as.data.frame() # ns ttt
lrt_germ_q <- lrt_interoms_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_q_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_germ_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "germ",
response = "ratio_q", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_low_germ_q <- summary(model_germ_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_medium_germ_q <- summary(model_germ_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
estimate_high_germ_q <- summary(model_germ_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "high", .before = 1)
estimate_germ_q <- estimate_low_germ_q |>
bind_rows(estimate_medium_germ_q) |>
bind_rows(estimate_high_germ_q) |>
rename(pvalue = "Pr(>|z|)") |>
mutate(method = method_name,
proxy = "germ",
response = "ratio_q", .before = 1)
### weight ----
model_weight_q_id_0 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + (1|session))
model_weight_q_id_1 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + ttt + (1|session))
model_weight_q_id_1b <- lme4::lmer(data = data_final_id |> filter(!is.na(ratio_q)), mean_seed_weight ~ ratio_q + ttt + (1|session))
model_weight_q_id_2 <- lme4::lmer(data = data_final_id |> filter(!is.na(ratio_q)), mean_seed_weight ~ ttt + (1|session))
model_weight_q_id_3 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + (1|session))
lrt_interoms_weight_q <- anova(model_weight_q_id_0, model_weight_q_id_1) |> as.data.frame() # ns ratio_q * ttt
lrt_q_weight_q <- anova(model_weight_q_id_1b, model_weight_q_id_2) |> as.data.frame() # marg sin ratio_q
lrt_ttt_weight_q <-anova(model_weight_q_id_1, model_weight_q_id_3) |> as.data.frame() # ns ttt
lrt_weight_q <- lrt_interoms_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "interq", .before = 1) |>
bind_rows(lrt_q_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ratio_q", .before = 1)) |>
bind_rows(lrt_ttt_weight_q |> slice(2) |> select(c("Chisq","Df","Pr(>Chisq)")) |> mutate(effect = "ttt", .before = 1)) |>
mutate(method = method_name,
proxy = "weight",
response = "ratio_q", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_weight_q_id_best <-  lmerTest::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + (1|session))
estimate_low_weight_q <- summary(model_weight_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "low", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_weight_q_id_best <-  lmerTest::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + (1|session))
estimate_medium_weight_q <- summary(model_weight_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "medium", .before = 1)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_weight_q_id_best <-  lmerTest::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + (1|session))
estimate_high_weight_q <- summary(model_weight_q_id_best)$coefficients |> as.data.frame() |> rownames_to_column() |>
filter(rowname == "ratio_q") |> mutate(ttt = "high", .before = 1)
estimate_weight_q <- estimate_low_weight_q |>
bind_rows(estimate_medium_weight_q) |>
bind_rows(estimate_high_weight_q) |>
rename(pvalue = "Pr(>|t|)") |>
mutate(method = method_name,
proxy = "weight",
response = "ratio_q", .before = 1)
lrt_table <- lrt_q_oms |>
bind_rows(lrt_ab_oms) |>
bind_rows(lrt_ss_oms) |>
bind_rows(lrt_germ_oms) |>
bind_rows(lrt_weight_oms) |>
bind_rows(lrt_ab_q) |>
bind_rows(lrt_ss_q) |>
bind_rows(lrt_germ_q) |>
bind_rows(lrt_weight_q) |>
rename(chisq = Chisq,
df = Df,
pvalue = "Pr(>Chisq)")
estimate_table <- estimate_q_oms |>
bind_rows(estimate_ab_oms) |>
bind_rows(estimate_ss_oms) |>
bind_rows(estimate_germ_oms) |>
bind_rows(estimate_weight_oms) |>
bind_rows(estimate_ab_q) |>
bind_rows(estimate_ss_q) |>
bind_rows(estimate_germ_q) |>
bind_rows(estimate_weight_q) |>
select(-c("t value","z value")) |>
rename(estimate = Estimate,
se = "Std. Error")
}
return(list(lrt_table = lrt_table,
estimate_table = estimate_table))
}
get_stat_id(data_final_id, include_contact = FALSE)
get_stat_id(data_final_id, include_contact = TRUE)
