anova(truc1,truc3)
# seed-set
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10+pl  + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10+pl  + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor+import_nb_part_ID_out_co10+pl  + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+import_nb_part_ID_out_co10+pl  + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10* poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+ poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor+import_nb_part_ID_out_co10+pl   + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10+pl   + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# seed weight
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full))
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full))
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full))
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full))
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full))
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10+pl + (1|session) + (1|session:ID_full))
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ poll_treat_factor+import_nb_part_ID_out_co10+pl  + (1|session) + (1|session:ID_full))
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10+pl  + (1|session) + (1|session:ID_full))
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# controlling for oms at the flower scale (complete dataset)
# prop avorted
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# prop germinated
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# seed-set
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10* poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor+import_nb_part_ID_out_co10   + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10   + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# seed weight
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full))
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full))
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# controlling for nothing
# prop avorted
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# prop germinated
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS*poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS+poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10*poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10+poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ poll_treat_factor  + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# seed-set
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS*poll_treat_factor  + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+poll_treat_factor  + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor  + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS  + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10* poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+ poll_treat_factor + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor   + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10   + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# seed weight
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS*poll_treat_factor + (1|session) + (1|session:ID_full))
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS+poll_treat_factor + (1|session) + (1|session:ID_full))
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ poll_treat_factor + (1|session) + (1|session:ID_full))
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), poids_sd ~ gMS + (1|session) + (1|session:ID_full))
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
truc0 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10*poll_treat_factor + (1|session) + (1|session:ID_full))
truc1 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+poll_treat_factor + (1|session) + (1|session:ID_full))
truc2 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ poll_treat_factor  + (1|session) + (1|session:ID_full))
truc3 <- lme4::glmer(data = test %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10  + (1|session) + (1|session:ID_full))
anova(truc0,truc1)
anova(truc1,truc2)
anova(truc1,truc3)
# controlling for oms at the flower scale (complete dataset)
# prop avorted
truc0 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc1 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc2 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
truc3 <- lme4::glmer(data = test %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(truc0,truc1)
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
# prop avorted
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
dt <- data_flower %>%
left_join(data_both_sexes %>%
filter(type=="fem") %>%
select(ID_full,gMS,nb_part_ID_out_co10), by = join_by(ID_full))
# prop avorted
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms2 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms3 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_av_gms0,coms_av_gms1)
anova(coms_av_gms1,coms_av_gms2)
anova(coms_av_gms1,coms_av_gms3)
coms_av_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms1 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms2 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms3 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_av_oms0,coms_av_oms1)
anova(coms_av_oms1,coms_av_oms2)
anova(coms_av_oms1,coms_av_oms3)
# prop germinated
coms_germ_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_germ_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_germ_gms2 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_germ_gms3 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_germ_gms0,coms_germ_gms1)
anova(coms_germ_gms1,coms_germ_gms2)
anova(coms_germ_gms1,coms_germ_gms3)
coms_germ_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_germ_oms1 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_germ_oms2 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
coms_germ_oms3 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_germ,(nbGr_semis - nbGr_germ)) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_germ_oms0,coms_germ_oms1)
anova(coms_germ_oms1,coms_germ_oms2)
anova(coms_germ_oms1,coms_germ_oms3)
# seed-set
coms_ss_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
coms_ss_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
coms_ss_gms2 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
coms_ss_gms3 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ gMS+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_ss_gms0,coms_ss_gms1)
anova(coms_ss_gms1,coms_ss_gms2)
anova(coms_ss_gms1,coms_ss_gms3)
coms_ss_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10* poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_ss_oms1 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_ss_oms2 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ poll_treat_factor+import_nb_part_ID_out_co10   + (1|session) + (1|session:ID_full),family = binomial)
coms_ss_oms3 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,(nbOv - nbGr_SR)) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10   + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_ss_oms0,coms_ss_oms1)
anova(coms_ss_oms1,coms_ss_oms2)
anova(coms_ss_oms1,coms_ss_oms3)
# seed weight
coms_weight_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), poids_sd ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
coms_weight_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), poids_sd ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
coms_weight_gms2 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), poids_sd ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
coms_weight_gms3 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), poids_sd ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
anova(coms_weight_gms0,coms_weight_gms1)
anova(coms_weight_gms1,coms_weight_gms2)
anova(coms_weight_gms1,coms_weight_gms3)
coms_weight_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
coms_weight_oms1 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full))
coms_weight_oms2 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ poll_treat_factor+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full))
coms_weight_oms3 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), poids_sd ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10  + (1|session) + (1|session:ID_full))
anova(coms_weight_oms0,coms_weight_oms1)
anova(coms_weight_oms1,coms_weight_oms2)
anova(coms_weight_oms1,coms_weight_oms3)
dt_sum <- dt %>%
mutate(prop_non_av = nbGr/(nbGr+nbAv)) %>%
group_by(poll_treat_factor) %>%
summarise(mean_prop_non_av = mean(prop_non_av,na.rm=T))
dt_sum
# prop avorted
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,nbAv) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms2 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms3 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr_SR,nbAv) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_av_gms0,coms_av_gms1)
anova(coms_av_gms1,coms_av_gms2)
anova(coms_av_gms1,coms_av_gms3)
coms_av_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms1 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,nbAv) ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms2 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms3 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr_SR,nbAv) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_av_oms0,coms_av_oms1)
anova(coms_av_oms1,coms_av_oms2)
anova(coms_av_oms1,coms_av_oms3)
dt_sum <- dt %>%
mutate(prop_non_av = nbGr/(nbGr+nbAv),
prop_germ = nbGr_germ/nbGr_semis,
seed_set = nbGr_SR/nbOv) %>%
group_by(poll_treat_factor) %>%
summarise(mean_prop_germ = mean(prop_germ,na.rm=T),
mean_seed_set = mean(seed_set,na.rm=T),
mean_weight_seed = mean(poids_sd,na.rm=T))
dt_sum
dt_sum <- dt %>%
mutate(prop_non_av = nbGr/(nbGr+nbAv),
prop_germ = nbGr_germ/nbGr_semis,
seed_set = nbGr_SR/nbOv) %>%
group_by(poll_treat_factor) %>%
summarise(mean_prop_non_av = mean(prop_non_av,na.rm=T),
mean_prop_germ = mean(prop_germ,na.rm=T),
mean_seed_set = mean(seed_set,na.rm=T),
mean_weight_seed = mean(poids_sd,na.rm=T))
dt_sum
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
gMS_av_low_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # low
gMS_av_low_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # low
gMS_av_low_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # low
gMS_av_low_est
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_med_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # med
gMS_av_med_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"]# med
gMS_av_med_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # med
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
gMS_av_low_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # low
gMS_av_low_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # low
gMS_av_low_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # low
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_med_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # med
gMS_av_med_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"]# med
gMS_av_med_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # med
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_high_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # high
gMS_av_high_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # high
gMS_av_high_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"]# high
tab_gMS_av <- tibble(ttt=c("low","medium","high"),
est=c(gMS_av_low_est,gMS_av_med_est,gMS_av_high_est),
se=c(gMS_av_low_se,gMS_av_med_se,gMS_av_high_se),
pval=c(gMS_av_low_pval,gMS_av_med_pval,gMS_av_high_pval)) %>%
mutate(est_low=est-1.96*se,
est_up=est+1.96*se) %>%
mutate(pval_stars=case_when(pval<0.001~"***",
pval<0.01~"**",
pval<0.05~"*",
TRUE~"")) %>%
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high")))
plot_gMS_av_fem <- ggplot(tab_gMS_av, aes(x=ttt, y=est, fill=ttt)) +
geom_hline(yintercept=0,color="gray60",linetype="dashed")+
geom_errorbar(aes(ymin=est_low, ymax=est_up,color=ttt), stat="identity",width=0,linewidth=3,lineend="butt") +
geom_point(size=4,shape=21,color="gray30",fill="white",stroke=1) +
scale_fill_manual(values=c("#DCBC93","#C89656","#81675F")) +
scale_color_manual(values=c("#DCBC93","#C89656","#81675F")) +
ggthemes::theme_calc(base_family = "sans") +
common_theme +
xlab("") +
ylab("\nProportion of non-aborted seeds \nin relation to genetic number of mates")  +
ylim(-0.3,1.1) +
scale_x_discrete(labels=c("low" = "LOW", "medium" = "MEDIUM", "high" = "HIGH")) +
geom_text(aes(y=est_up,label=pval_stars,color=ttt),vjust=-0.2, size=4)
#'
#' @description
#'
#' @param
#'
#' @return
#'
#' @import dplyr
#'
#' @export
get_common_theme <- function(){
common_theme <- theme(axis.text.x = element_text(size=10,angle=45,hjust=1),
axis.text.y = element_text(size=8,margin = margin(t = 0, r = 5, b = 0, l = 5)),
legend.position = "none",
plot.background = element_blank(),
panel.grid.major=element_blank(),
plot.margin = margin(t=5, r=5, b=5, l=5),
strip.background = element_rect(colour="black",
linewidth=1.5, linetype="solid"),
panel.background = element_rect(colour="black", fill="white",linewidth=1),
axis.title.y = element_text(size=12))
return(common_theme)
}
plot_gMS_av_fem <- ggplot(tab_gMS_av, aes(x=ttt, y=est, fill=ttt)) +
geom_hline(yintercept=0,color="gray60",linetype="dashed")+
geom_errorbar(aes(ymin=est_low, ymax=est_up,color=ttt), stat="identity",width=0,linewidth=3,lineend="butt") +
geom_point(size=4,shape=21,color="gray30",fill="white",stroke=1) +
scale_fill_manual(values=c("#DCBC93","#C89656","#81675F")) +
scale_color_manual(values=c("#DCBC93","#C89656","#81675F")) +
ggthemes::theme_calc(base_family = "sans") +
get_common_theme() +
xlab("") +
ylab("\nProportion of non-aborted seeds \nin relation to genetic number of mates")  +
ylim(-0.3,1.1) +
scale_x_discrete(labels=c("low" = "LOW", "medium" = "MEDIUM", "high" = "HIGH")) +
geom_text(aes(y=est_up,label=pval_stars,color=ttt),vjust=-0.2, size=4)
plot_gMS_av_fem
plot_gMS_av_fem <- ggplot(tab_gMS_av, aes(x=ttt, y=est, fill=ttt)) +
geom_hline(yintercept=0,color="gray60",linetype="dashed")+
geom_errorbar(aes(ymin=est_low, ymax=est_up,color=ttt), stat="identity",width=0,linewidth=3,lineend="butt") +
geom_point(size=4,shape=21,color="gray30",fill="white",stroke=1) +
scale_fill_manual(values=c("#DCBC93","#C89656","#81675F")) +
scale_color_manual(values=c("#DCBC93","#C89656","#81675F")) +
ggthemes::theme_calc(base_family = "sans") +
get_common_theme() +
xlab("") +
ylab("\nProportion of non-aborted seeds \nin relation to genetic number of mates")  +
# ylim(-0.3,1.1) +
scale_x_discrete(labels=c("low" = "LOW", "medium" = "MEDIUM", "high" = "HIGH")) +
geom_text(aes(y=est_up,label=pval_stars,color=ttt),vjust=-0.2, size=4)
plot_gMS_av_fem
gMS_av_high_est
gMS_av_med_est
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
gMS_av_low_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # low
gMS_av_low_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # low
gMS_av_low_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # low
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_med_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # med
gMS_av_med_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"]# med
gMS_av_med_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # med
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_high_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # high
gMS_av_high_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # high
gMS_av_high_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"]# high
gMS_av_high_est
gMS_av_med_est
summary(coms_av_gms0)
# prop avorted
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms1 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms2 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_gms3 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_av_gms0,coms_av_gms1)
anova(coms_av_gms1,coms_av_gms2)
anova(coms_av_gms1,coms_av_gms3)
scaleFUN <- function(x){sprintf("%.1f", x)}
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
summary(coms_av_gms0)
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
summary(coms_av_gms0)
gMS_av_low_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # low
gMS_av_low_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # low
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
summary(coms_av_gms0)
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_low_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # low
gMS_av_low_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # low
gMS_av_low_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # low
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_med_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # med
gMS_av_med_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"]# med
gMS_av_med_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"] # med
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("high","low","medium")))
coms_av_gms0 <- lme4::glmer(data = dt %>% filter(!is.na(gMS)), cbind(nbGr,nbAv) ~ gMS*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
gMS_av_high_est <- summary(coms_av_gms0)$coefficients["gMS","Estimate"] # high
gMS_av_high_se <- summary(coms_av_gms0)$coefficients["gMS","Std. Error"] # high
gMS_av_high_pval <- summary(coms_av_gms0)$coefficients["gMS","Pr(>|z|)"]# high
tab_gMS_av <- tibble(ttt=c("low","medium","high"),
est=c(gMS_av_low_est,gMS_av_med_est,gMS_av_high_est),
se=c(gMS_av_low_se,gMS_av_med_se,gMS_av_high_se),
pval=c(gMS_av_low_pval,gMS_av_med_pval,gMS_av_high_pval)) %>%
mutate(est_low=est-1.96*se,
est_up=est+1.96*se) %>%
mutate(pval_stars=case_when(pval<0.001~"***",
pval<0.01~"**",
pval<0.05~"*",
TRUE~"")) %>%
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high")))
plot_gMS_av_fem <- ggplot(tab_gMS_av, aes(x=ttt, y=est, fill=ttt)) +
geom_hline(yintercept=0,color="gray60",linetype="dashed")+
geom_errorbar(aes(ymin=est_low, ymax=est_up,color=ttt), stat="identity",width=0,linewidth=3,lineend="butt") +
geom_point(size=4,shape=21,color="gray30",fill="white",stroke=1) +
scale_fill_manual(values=c("#DCBC93","#C89656","#81675F")) +
scale_color_manual(values=c("#DCBC93","#C89656","#81675F")) +
ggthemes::theme_calc(base_family = "sans") +
get_common_theme() +
xlab("") +
ylab("\nProportion of non-aborted seeds \nin relation to genetic number of mates")  +
# ylim(-0.3,1.1) +
scale_x_discrete(labels=c("low" = "LOW", "medium" = "MEDIUM", "high" = "HIGH")) +
geom_text(aes(y=est_up,label=pval_stars,color=ttt),vjust=-0.2, size=4)
plot_gMS_av_fem
coms_av_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms1 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms2 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
coms_av_oms3 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
anova(coms_av_oms0,coms_av_oms1)
anova(coms_av_oms1,coms_av_oms2)
anova(coms_av_oms1,coms_av_oms3)
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("low","medium","high")))
coms_av_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
oMS_av_low_est <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Estimate"] # low
oMS_av_low_se <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Std. Error"] # low
oMS_av_low_pval <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Pr(>|z|)"] # low
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("medium","high","low")))
coms_av_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
oMS_av_med_est <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Estimate"] # med
oMS_av_med_se <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Std. Error"]# med
oMS_av_med_pval <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Pr(>|z|)"] # med
dt <- dt %>%
mutate(poll_treat_factor=forcats::fct_relevel(poll_treat_factor, c("high","low","medium")))
coms_av_oms0 <- lme4::glmer(data = dt %>% filter(!is.na(nb_part_ID_out_co10)), cbind(nbGr,nbAv) ~ nb_part_ID_out_co10*poll_treat_factor+import_nb_part_ID_out_co10 + (1|session) + (1|session:ID_full),family = binomial)
oMS_av_high_est <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Estimate"] # high
oMS_av_high_se <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Std. Error"] # high
oMS_av_high_pval <- summary(coms_av_oms0)$coefficients["nb_part_ID_out_co10","Pr(>|z|)"]# high
tab_oMS_av <- tibble(ttt=c("low","medium","high"),
est=c(oMS_av_low_est,oMS_av_med_est,oMS_av_high_est),
se=c(oMS_av_low_se,oMS_av_med_se,oMS_av_high_se),
pval=c(oMS_av_low_pval,oMS_av_med_pval,oMS_av_high_pval)) %>%
mutate(est_low=est-1.96*se,
est_up=est+1.96*se) %>%
mutate(pval_stars=case_when(pval<0.001~"***",
pval<0.01~"**",
pval<0.05~"*",
TRUE~"")) %>%
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high")))
plot_oMS_av_fem <- ggplot(tab_oMS_av, aes(x=ttt, y=est, fill=ttt)) +
geom_hline(yintercept=0,color="gray60",linetype="dashed")+
geom_errorbar(aes(ymin=est_low, ymax=est_up,color=ttt), stat="identity",width=0,linewidth=3,lineend="butt") +
geom_point(size=4,shape=21,color="gray30",fill="white",stroke=1) +
scale_fill_manual(values=c("#DCBC93","#C89656","#81675F")) +
scale_color_manual(values=c("#DCBC93","#C89656","#81675F")) +
ggthemes::theme_calc(base_family = "sans") +
get_common_theme() +
xlab("") +
ylab("\nProportion of non-aborted seeds \nin relation to genetic number of mates")  +
# ylim(-0.3,1.1) +
scale_x_discrete(labels=c("low" = "LOW", "medium" = "MEDIUM", "high" = "HIGH")) +
geom_text(aes(y=est_up,label=pval_stars,color=ttt),vjust=-0.2, size=4)
plot_oMS_av_fem
