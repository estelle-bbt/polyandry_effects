anova(model_ab_q_flower_3b, model_ab_q_flower_6) # ns pl
summary(model_ab_q_flower_1)
# seed-set
model_ss_q_flower_0 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q * ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_1 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_2 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q * ttt + pl + ttt + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3a <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3b <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_4 <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_seed, nb_ov - nb_seed) ~ ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_5 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_6 <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + (1|session) + (1|session:id), family = "binomial")
anova(model_ss_q_flower_0, model_ss_q_flower_1) # ns ratio_q * ttt
anova(model_ss_q_flower_0, model_ss_q_flower_2) # marg sign pl * ttt
anova(model_ss_q_flower_0, model_ss_q_flower_1) # ns ratio_q * ttt
anova(model_ss_q_flower_0, model_ss_q_flower_2) # marg sign pl * ttt
anova(model_ss_q_flower_3a, model_ss_q_flower_4) # ns ratio_q
anova(model_ss_q_flower_3, model_ss_q_flower_5) # ns ttt
anova(model_ss_q_flower_3b, model_ss_q_flower_6) # sign pl
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ss_q_flower_best <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
summary(model_ss_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ss_q_flower_best <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
summary(model_ss_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ss_q_flower_best <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
summary(model_ss_q_flower_best)
# germ
model_germ_q_flower_0 <- lme4::glmer(data = data_final_flower, cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q * ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_1 <- lme4::glmer(data = data_final_flower, cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_2 <- lme4::glmer(data = data_final_flower, cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q * ttt + pl + ttt + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_3 <- lme4::glmer(data = data_final_flower, cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_3a <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_3b <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_4 <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_germ, nb_sown - nb_germ) ~ ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_5 <- lme4::glmer(data = data_final_flower, cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q + pl + (1|session) + (1|session:id), family = "binomial")
model_germ_q_flower_6 <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_germ, nb_sown - nb_germ) ~ ratio_q + ttt + (1|session) + (1|session:id), family = "binomial")
anova(model_germ_q_flower_0, model_germ_q_flower_1) # ns ratio_q * ttt
anova(model_germ_q_flower_0, model_germ_q_flower_2) # ns pl * ttt
anova(model_germ_q_flower_3a, model_germ_q_flower_4) # ns ratio_q
anova(model_germ_q_flower_3, model_germ_q_flower_5) # ns ttt
anova(model_germ_q_flower_3b, model_germ_q_flower_6) # ns pl
# weight
model_weight_q_flower_0 <- lme4::lmer(data = data_final_flower, seed_weight ~ ratio_q * ttt + pl * ttt + (1|session) + (1|session:id))
model_weight_q_flower_1 <- lme4::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
model_weight_q_flower_2 <- lme4::lmer(data = data_final_flower, seed_weight ~ ratio_q * ttt + pl + ttt + (1|session) + (1|session:id))
model_weight_q_flower_3 <- lme4::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl + (1|session) + (1|session:id))
model_weight_q_flower_3a <- lme4::lmer(data = data_final_flower |> filter (!is.na(ratio_q)), seed_weight ~ ratio_q + ttt + pl + (1|session) + (1|session:id))
model_weight_q_flower_3b <- lme4::lmer(data = data_final_flower |> filter (!is.na(pl)), seed_weight ~ ratio_q + ttt + pl + (1|session) + (1|session:id))
model_weight_q_flower_4 <- lme4::lmer(data = data_final_flower |> filter (!is.na(ratio_q)), seed_weight ~ ttt + pl + (1|session) + (1|session:id))
model_weight_q_flower_5 <- lme4::lmer(data = data_final_flower, seed_weight ~ ratio_q + pl + (1|session) + (1|session:id))
model_weight_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter (!is.na(pl)), seed_weight ~ ratio_q + ttt + (1|session) + (1|session:id))
anova(model_weight_q_flower_0, model_weight_q_flower_1) # ns ratio_q * ttt
anova(model_weight_q_flower_0, model_weight_q_flower_2) # sign pl * ttt
anova(model_weight_q_flower_3a, model_weight_q_flower_4) # ns ratio_q
anova(model_weight_q_flower_3, model_weight_q_flower_5) # ns ttt
anova(model_weight_q_flower_3b, model_weight_q_flower_6) # ns pl
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_weight_q_flower_best <- lme4::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
model_ss_q_flower_best <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
summary(model_ss_q_flower_best)
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
anova(model_weight_q_flower_0, model_weight_q_flower_1) # ns ratio_q * ttt
anova(model_weight_q_flower_0, model_weight_q_flower_2) # sign pl * ttt
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
data_final_flower <- data_final_flower |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_weight_q_flower_best <- lmerTest::lmer(data = data_final_flower, seed_weight ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id))
summary(model_weight_q_flower_best)
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(data_final)
data_final_flower <- data_final$data_final_flower
## seed-set ----
model_ss_q_flower_0 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q * ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_1 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl * ttt + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_2 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q * ttt + pl + ttt + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3a <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3b <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_4 <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_seed, nb_ov - nb_seed) ~ ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_5 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_6 <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + (1|session) + (1|session:id), family = "binomial")
data_final_flower
library(tidyverse)
model_ss_q_flower_3 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3a <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_3b <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_4 <- lme4::glmer(data = data_final_flower |> filter (!is.na(ratio_q)), cbind(nb_seed, nb_ov - nb_seed) ~ ttt + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_5 <- lme4::glmer(data = data_final_flower, cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + pl + (1|session) + (1|session:id), family = "binomial")
model_ss_q_flower_6 <- lme4::glmer(data = data_final_flower |> filter (!is.na(pl)), cbind(nb_seed, nb_ov - nb_seed) ~ ratio_q + ttt + (1|session) + (1|session:id), family = "binomial")
anova(model_ss_q_flower_0, model_ss_q_flower_1) # ns ratio_q * ttt
anova(model_ss_q_flower_0, model_ss_q_flower_2) # marg sign pl * ttt
anova(model_ss_q_flower_3a, model_ss_q_flower_4) # ns ratio_q
anova(model_ss_q_flower_3, model_ss_q_flower_5) # ns ttt
anova(model_ss_q_flower_3b, model_ss_q_flower_6) # sign pl
data_final_id <- data_final$data_final_id
# effect of oms on q ratio ----
model_q_oms_flower_0 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + (1|session))
model_q_oms_flower_1 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + (1|session))
model_q_oms_flower_2 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + (1|session))
model_q_oms_flower_3 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + (1|session))
anova(model_q_oms_flower_0, model_q_oms_flower_1) # sign oms * ttt
anova(model_q_oms_flower_1, model_q_oms_flower_2) # ns pl * ttt
anova(model_q_oms_flower_1, model_q_oms_flower_3) # sign oms
# effect of oms on q ratio ----
model_q_oms_flower_0 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + (1|session))
model_q_oms_flower_1 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + (1|session))
model_q_oms_flower_2 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + (1|session))
model_q_oms_flower_3 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + (1|session))
anova(model_q_oms_flower_0, model_q_oms_flower_1) # ns oms * ttt
anova(model_q_oms_flower_1, model_q_oms_flower_2) # sign oms
# effect of oms on q ratio ----
model_q_oms_id_0 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + (1|session))
model_q_oms_id_1 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + (1|session))
model_q_oms_id_2 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + (1|session))
model_q_oms_id_3 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + (1|session))
anova(model_q_oms_id_0, model_q_oms_id_1) # ns oms * ttt
anova(model_q_oms_id_1, model_q_oms_id_2) # sign oms
anova(model_q_oms_id_1, model_q_oms_id_3) # ns ttt
# effect of oms on rs proxies ----
## aborted ----
model_ab_oms_id_0 <- lme4::glmer(data = data_final_flower, cbind(nb_seed,nb_ab) ~ oms * ttt + (1|session), family = "binomial")
model_ab_oms_id_1 <- lme4::glmer(data = data_final_flower, cbind(nb_seed,nb_ab) ~ oms + ttt + (1|session), family = "binomial")
model_ab_oms_id_2 <- lme4::glmer(data = data_final_flower, cbind(nb_seed,nb_ab) ~ ttt + (1|session), family = "binomial")
model_ab_oms_id_3 <- lme4::glmer(data = data_final_flower, cbind(nb_seed,nb_ab) ~ oms + (1|session), family = "binomial")
anova(model_ab_oms_id_0, model_ab_oms_id_1) # ns oms * ttt
anova(model_ab_oms_id_1, model_ab_oms_id_2) # sign oms
anova(model_ab_oms_id_1, model_ab_oms_id_3) # ns ttt
data_final_id
# effect of oms on q ratio ----
model_q_oms_id_0 <- lme4::lmer(data = data_final_id, ratio_q ~ oms * ttt + (1|session))
model_q_oms_id_1 <- lme4::lmer(data = data_final_id, ratio_q ~ oms + ttt + (1|session))
model_q_oms_id_2 <- lme4::lmer(data = data_final_id, ratio_q ~ ttt + (1|session))
model_q_oms_id_3 <- lme4::lmer(data = data_final_id, ratio_q ~ oms + (1|session))
anova(model_q_oms_id_0, model_q_oms_id_1) # ns oms * ttt
anova(model_q_oms_id_1, model_q_oms_id_2) # sign oms
anova(model_q_oms_id_1, model_q_oms_id_2) # marg sin oms
anova(model_q_oms_id_1, model_q_oms_id_3) # ns ttt
# effect of oms on rs proxies ----
## aborted ----
model_ab_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
model_ab_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + ttt + (1|session), family = "binomial")
model_ab_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + (1|session), family = "binomial")
anova(model_ab_oms_id_0, model_ab_oms_id_1) # sign oms * ttt
anova(model_ab_oms_id_1, model_ab_oms_id_2) # ns oms
View(data_final_id)
file_path_obs = "data/data_ABPOLL_ID_level_detflo.txt"
# id that only received self pollen = true 0 MS
only_self_id <- read.table(file_path_obs,head=T) |>
filter(!session %in% c("5.FA1","5.MO1"))  |>
group_by(ID_full_part) |>
summarise(
# nb individual with export
n_nonzero = sum(export_nb_visit_co10 != 0),
# si la seule ligne non nulle correspond à un "self"
self_only = ifelse(
n_nonzero == 1 &
all(ID_full_foc[export_nb_visit_co10 != 0] == ID_full_part[export_nb_visit_co10 != 0]),
1, 0
),
.groups = "drop"
) |>
select(ID_full_part, self_only) |>
filter (self_only == 1) |>
mutate(oms = 0) |>
rename(id = ID_full_part) |>
select(-self_only)
only_self_id
read.table(file_path_obs,head=T) |>
filter(!session %in% c("5.FA1","5.MO1"))  |>
group_by(ID_full_part) |>
summarise(
# nb individual with export
n_nonzero = sum(export_nb_visit_co10 != 0),
# si la seule ligne non nulle correspond à un "self"
self_only = ifelse(
n_nonzero == 1 &
all(ID_full_foc[export_nb_visit_co10 != 0] == ID_full_part[export_nb_visit_co10 != 0]),
1, 0
),
.groups = "drop"
)
read.table(file_path_obs,head=T) |>
filter(!session %in% c("5.FA1","5.MO1"))  |>
group_by(ID_full_part) |>
summarise(
# nb individual with export
n_nonzero = sum(export_nb_visit_co10 != 0),
# si la seule ligne non nulle correspond à un "self"
self_only = ifelse(
n_nonzero == 1 &
all(ID_full_foc[export_nb_visit_co10 != 0] == ID_full_part[export_nb_visit_co10 != 0]),
1, 0
),
.groups = "drop"
) |>
select(ID_full_part, self_only) |>
filter (self_only == 1)
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(data_final)
data_final_id <- data_final$data_final_id
# effect of oms on q ratio ----
model_q_oms_id_0 <- lme4::lmer(data = data_final_id, ratio_q ~ oms * ttt + (1|session))
model_q_oms_id_1 <- lme4::lmer(data = data_final_id, ratio_q ~ oms + ttt + (1|session))
model_q_oms_id_2 <- lme4::lmer(data = data_final_id, ratio_q ~ ttt + (1|session))
model_q_oms_id_3 <- lme4::lmer(data = data_final_id, ratio_q ~ oms + (1|session))
anova(model_q_oms_id_0, model_q_oms_id_1) # ns oms * ttt
anova(model_q_oms_id_1, model_q_oms_id_2) # marg sin oms
anova(model_q_oms_id_1, model_q_oms_id_3) # ns ttt
# effect of oms on rs proxies ----
## aborted ----
model_ab_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
model_ab_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + ttt + (1|session), family = "binomial")
model_ab_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + (1|session), family = "binomial")
anova(model_ab_oms_id_0, model_ab_oms_id_1) # sign oms * ttt
anova(model_ab_oms_id_1, model_ab_oms_id_2) # ns oms
anova(model_ab_oms_id_1, model_ab_oms_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
data_final_id
targets::tar_load(data_flower)
data_flower$ttt
targets::tar_load(data_proxy_id)
data_proxy_id$ttt
# proportion non-aborted
data_proxy_ab <- data_flower %>%
filter(!(is.na(nb_ab)|is.na(nb_seed))) %>%
group_by(id,session,ttt) %>%
summarise(nb_ab_sum_ab=sum(nb_ab,na.rm=T),
nb_seed_sum_ab=sum(nb_seed,na.rm=T))
data_proxy_ab
# seed-set
data_proxy_ss <- data_flower %>%
filter(!(is.na(nb_ov)|is.na(nb_seed))) %>%
group_by(id,session,ttt) %>%
summarise(nb_ov_sum_ss=sum(nb_ov,na.rm=T),
nb_seed_sum_ss=sum(nb_seed,na.rm=T))
data_proxy_ss
# proportion germinated
data_proxy_germ <- data_flower %>%
filter(!(is.na(nb_sown)|is.na(nb_germ))) %>%
group_by(id,session,ttt) %>%
summarise(nb_sown_sum_germ=sum(nb_sown,na.rm=T),
nb_germ_sum_germ=sum(nb_germ,na.rm=T))
data_proxy_germ
# proportion germinated
data_proxy_weight <- data_flower %>%
group_by(id,session,ttt) %>%
summarise(mean_seed_weight=mean(seed_weight,na.rm=T))
data_proxy_weight
data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup()
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate_all(~ifelse(is.nan(.), NA, .)) |> # for id without seed weight
filter(if_any(4:10, ~ !is.na(.)))  # remove id without data
data_proxy_id
data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup()
data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate_all(~ifelse(is.nan(.), NA, .))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate(across(4:10, ~ ifelse(is.nan(.), NA, .))) |> # for id without seed weight
filter(if_any(4:10, ~ !is.na(.)))  # remove id without data
data_proxy_id
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(data_final)
data_final_id <- data_final$data_final_id
# effect of oms on rs proxies ----
## aborted ----
model_ab_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
model_ab_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + ttt + (1|session), family = "binomial")
model_ab_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms + (1|session), family = "binomial")
anova(model_ab_oms_id_0, model_ab_oms_id_1) # sign oms * ttt
anova(model_ab_oms_id_1, model_ab_oms_id_2) # ns oms
anova(model_ab_oms_id_1, model_ab_oms_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ab_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ab_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ab_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ab_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ab_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ oms * ttt + (1|session), family = "binomial")
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
## seed-set ----
model_ss_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
model_ss_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms + ttt + (1|session), family = "binomial")
model_ss_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ttt + (1|session), family = "binomial")
model_ss_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms + (1|session), family = "binomial")
anova(model_ss_oms_id_0, model_ss_oms_id_1) # ns oms * ttt
anova(model_ss_oms_id_1, model_ss_oms_id_2) # sign oms
anova(model_ss_oms_id_1, model_ss_oms_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ss_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ss_oms_id_best
)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ss_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ss_oms_id_best
)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ss_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ oms * ttt + (1|session), family = "binomial")
summary(model_ss_oms_id_best
)
## germ ----
model_germ_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
model_germ_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms + ttt + (1|session), family = "binomial")
model_germ_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_nb_germ_sum_germgerm, nb_sown_sum_germ - nb_germ_sum_germ) ~ ttt + (1|session), family = "binomial")
model_germ_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms + (1|session), family = "binomial")
## germ ----
model_germ_oms_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
model_germ_oms_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms + ttt + (1|session), family = "binomial")
model_germ_oms_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ttt + (1|session), family = "binomial")
model_germ_oms_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms + (1|session), family = "binomial")
anova(model_germ_oms_id_0, model_germ_oms_id_1) # ns oms * ttt
anova(model_germ_oms_id_1, model_germ_oms_id_2) # sign oms
anova(model_germ_oms_id_1, model_germ_oms_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
summary(model_germ_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
summary(model_germ_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
summary(model_germ_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
summary(model_germ_oms_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_germ_oms_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ oms * ttt + (1|session), family = "binomial")
summary(model_germ_oms_id_best)
## weight ----
model_weight_oms_id_0 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ oms * ttt + (1|session))
model_weight_oms_id_1 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ oms + ttt + (1|session))
model_weight_oms_id_2 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ttt + (1|session))
model_weight_oms_id_3 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ oms + (1|session))
anova(model_weight_oms_id_0, model_weight_oms_id_1) # ns oms * ttt
anova(model_weight_oms_id_1, model_weight_oms_id_2) # sign oms
anova(model_weight_oms_id_1, model_weight_oms_id_3) # ns ttt
# effect of ratio_q on rs proxies ----
## aborted ----
model_ab_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
model_ab_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ab_q_id_2 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + (1|session), family = "binomial")
anova(model_ab_q_id_0, model_ab_q_id_1) # sign ratio_q * ttt
anova(model_ab_q_id_1, model_ab_q_id_2) # ns ratio_q
# effect of ratio_q on rs proxies ----
## aborted ----
model_ab_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
model_ab_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ab_q_id_1b <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) |> filter(!is.na(ratio_q)) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ab_q_id_1b <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)) , cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ab_q_id_2 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)) , cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ttt + (1|session), family = "binomial")
model_ab_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q + (1|session), family = "binomial")
anova(model_ab_q_id_0, model_ab_q_id_1) # sign ratio_q * ttt
anova(model_ab_q_id_1b, model_ab_q_id_2) # ns ratio_q
anova(model_ab_q_id_1, model_ab_q_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ab_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_ab_q_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ab_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_ab_q_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ab_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ab,nb_ab_sum_ab) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_ab_q_id_best)
## seed-set ----
model_ss_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
model_ss_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ss_q_id_1b <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + ttt + (1|session), family = "binomial")
model_ss_q_id_2 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ttt + (1|session), family = "binomial")
model_ss_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q + (1|session), family = "binomial")
anova(model_ss_q_id_0, model_ss_q_id_1) # ns ratio_q * ttt
anova(model_ss_q_id_1b, model_ss_q_id_2) # sign ratio_q
anova(model_ss_q_id_1, model_ss_q_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_ss_q_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_ss_q_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_ss_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_seed_sum_ss, nb_ov_sum_ss - nb_seed_sum_ss) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_ss_q_id_best)
## germ ----
model_germ_q_id_0 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
model_germ_q_id_1 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + (1|session), family = "binomial")
model_germ_q_id_1b <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + ttt + (1|session), family = "binomial")
model_germ_q_id_2 <- lme4::glmer(data = data_final_id |> filter(!is.na(ratio_q)), cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ttt + (1|session), family = "binomial")
model_germ_q_id_3 <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q + (1|session), family = "binomial")
anova(model_germ_q_id_0, model_germ_q_id_1) # ns ratio_q * ttt
anova(model_germ_q_id_1b, model_germ_q_id_2) # sign ratio_q
anova(model_germ_q_id_1, model_germ_q_id_3) # ns ttt
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "low"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_germ_q_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "medium"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_germ_q_id_best)
data_final_id <- data_final_id |>
mutate(ttt=forcats::fct_relevel(ttt, "high"))
model_germ_q_id_best <- lme4::glmer(data = data_final_id, cbind(nb_germ_sum_germ, nb_sown_sum_germ - nb_germ_sum_germ) ~ ratio_q * ttt + (1|session), family = "binomial")
summary(model_germ_q_id_best)
## weight ----
model_weight_q_id_0 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q * ttt + (1|session))
model_weight_q_id_1 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + ttt + (1|session))
model_weight_q_id_1b <- lme4::lmer(data = data_final_id, mean_seed_weight |> filter(!is.na(ratio_q))~ ratio_q + ttt + (1|session))
model_weight_q_id_2 <- lme4::lmer(data = data_final_id, mean_seed_weight |> filter(!is.na(ratio_q))~ ttt + (1|session))
model_weight_q_id_1b <- lme4::lmer(data = data_final_id |> filter(!is.na(ratio_q)), mean_seed_weight ~ ratio_q + ttt + (1|session))
model_weight_q_id_2 <- lme4::lmer(data = data_final_id |> filter(!is.na(ratio_q)), mean_seed_weight ~ ttt + (1|session))
model_weight_q_id_3 <- lme4::lmer(data = data_final_id, mean_seed_weight ~ ratio_q + (1|session))
anova(model_weight_q_id_0, model_weight_q_id_1) # ns ratio_q * ttt
anova(model_weight_q_id_1b, model_weight_q_id_2) # sign ratio_q
anova(model_weight_q_id_1, model_weight_q_id_3) # ns ttt
