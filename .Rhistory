mutate(flower_id = sub("_[^_]+$", "", offspring_id)) |>
mutate(couple_gen = paste0(candidate_id,"_",flower_id)) |>
filter(couple_gen %in% obs_only$couple_obs)
dim(gen_clean)
oms_gms_flower <- obs_clean |>
group_by(ID_full_part,id_flow_part) |>
summarise(oms = n_distinct(ID_full_foc)) |>
rename(id = ID_full_part,
id_flow = id_flow_part) |>
left_join(gen_clean |>
group_by(known_id, flower_id) |>
summarise(gms = n_distinct(candidate_id)) |>
rename(id = known_id,
id_flow = flower_id))
oms_gms_flower
# couples with observed visits only (carry-over 10)
obs_clean <- read.table(file_path_obs,head=T) |>
filter(!session %in% c("5.FA1","5.MO1"))  |>
select(session,ID_full_foc,ID_full_part,id_flow_part,export_nb_visit_co10) |>
filter(ID_full_foc != ID_full_part)  |>
filter(!(is.na(export_nb_visit_co10)|export_nb_visit_co10==0)) |>
mutate(couple_obs = paste0(ID_full_foc,"_",id_flow_part)) |>
rename(id = ID_full_part,
id_flow = id_flow_part)
# filtering only observed contact
gen_clean <- read.table(file_path_gen,head=T) |>
filter(known_id != candidate_id) |>
mutate(offspring_id = stringr::str_remove(offspring_id, pattern = "_run3"),
offspring_id = stringr::str_remove(offspring_id, pattern = "a"),
offspring_id = stringr::str_remove(offspring_id, pattern = "b")) |>
mutate(flower_id = sub("_[^_]+$", "", offspring_id)) |>
mutate(couple_gen = paste0(candidate_id,"_",flower_id)) |>
filter(couple_gen %in% obs_only$couple_obs)  |>
rename(id = known_id,
id_flow = flower_id)
oms_gms_flower <- obs_clean |>
group_by(ID_full_part,id_flow_part) |>
summarise(oms = n_distinct(ID_full_foc))  |>
left_join(gen_clean |>
group_by(known_id, flower_id) |>
summarise(gms = n_distinct(candidate_id)))
oms_gms_flower <- obs_clean |>
group_by(id,id_flow) |>
summarise(oms = n_distinct(ID_full_foc))  |>
left_join(gen_clean |>
group_by(id, id_flow) |>
summarise(gms = n_distinct(candidate_id)))
oms_gms_flower
oms_gms_id <- obs_clean |>
group_by(id) |>
summarise(oms = n_distinct(ID_full_foc))  |>
left_join(gen_clean |>
group_by(id) |>
summarise(gms = n_distinct(candidate_id)))
oms_gms_id
View(oms_gms_id)
View(data_flower)
group_by(ID_full,session,poll_treat_factor) %>%
summarise(nb_ab_sum_ab=sum(nbAv,na.rm=T),
nb_seed_sum_ab=sum(nbGr_SR,na.rm=T)))
group_by(ID_full,session,poll_treat_factor) %>%
summarise(nb_ab_sum_ab=sum(nbAv,na.rm=T),
nb_seed_sum_ab=sum(nbGr_SR,na.rm=T))
data_flower <- read.table(file_path,head=T) |>
mutate(ttt=as.factor(case_when(poll_treat==1~"low",
poll_treat==2~"medium",
TRUE~"high"))) |>
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high")))
file_path = "data/data_ABPOLL_flower_resume.txt"
data_flower <- read.table(file_path,head=T) |>
mutate(ttt=as.factor(case_when(poll_treat==1~"low",
poll_treat==2~"medium",
TRUE~"high"))) |>
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high")))
# proportion non-aborted
data_proxy_ovav <- data_flower %>%
filter(is.na(nbAv)|is.na(nbGr_SR))) %>%
# proportion non-aborted
data_proxy_ovav <- data_flower %>%
filter(!(is.na(nbAv)|is.na(nbGr_SR))) %>%
group_by(id,session,ttt) %>%
summarise(nb_ab_sum_ab=sum(nbAv,na.rm=T),
nb_seed_sum_ab=sum(nbGr_SR,na.rm=T))
# proportion non-aborted
data_proxy_ovav <- data_flower %>%
filter(!(is.na(nbAv)|is.na(nbGr_SR))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_ab_sum_ab=sum(nbAv,na.rm=T),
nb_seed_sum_ab=sum(nbGr_SR,na.rm=T))
data_proxy_ovav
# seed-set
data_proxy_ss <- data_flower %>%
filter(!(is.na(nbOv)|is.na(nbGr_SR))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_ov_sum_ss=sum(nbOv,na.rm=T),
nb_seed_sum_ss=sum(nbGr_SR,na.rm=T))
data_proxy_ss
data_flower <- read.table(file_path,head=T) |>
mutate(ttt=as.factor(case_when(poll_treat==1~"low",
poll_treat==2~"medium",
TRUE~"high"))) |>
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high"))) |>
rename(ID_full = id)
data_flower$nbGr_semis
data_flower$poids_sd
# proportion non-aborted
data_proxy_ab <- data_flower %>%
filter(!(is.na(nbAv)|is.na(nbGr_SR))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_ab_sum_ab=sum(nbAv,na.rm=T),
nb_seed_sum_ab=sum(nbGr_SR,na.rm=T))
# seed-set
data_proxy_ss <- data_flower %>%
filter(!(is.na(nbOv)|is.na(nbGr_SR))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_ov_sum_ss=sum(nbOv,na.rm=T),
nb_seed_sum_ss=sum(nbGr_SR,na.rm=T))
# proportion germinated
data_proxy_germ <- data_flower %>%
filter(!(is.na(nbGr_semis)|is.na(nbGr_germ))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_sown_sum_germ=sum(nbGr_semis,na.rm=T),
nb_germ_sum_germ=sum(nbGr_germ,na.rm=T))
# proportion germinated
data_proxy_weight <- data_flower %>%
group_by(ID_full,session,ttt) %>%
summarise(mean_seed_weight=mean(poids_sd,na.rm=T))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss)
data_proxy_id
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight)
View(data_proxy_id)
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
mutate_all(~ifelse(is.nan(.), NA, .))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
mutate_at(~ifelse(is.nan(.), NA, .))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate_all(~ifelse(is.nan(.), NA, .))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate_all(~ifelse(is.nan(.), NA, .)) |>
filter(if_any(everything(), ~ !is.na(.)))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate_all(~ifelse(is.nan(.), NA, .)) |>
filter(if_any(4:10, ~ !is.na(.)))
data_flower <- read.table(file_path,head=T) |>
mutate(ttt=as.factor(case_when(poll_treat==1~"low",
poll_treat==2~"medium",
TRUE~"high"))) |>
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high"))) |>
rename(nb_ab = nbAv,
nb_ov = nbOv,
nb_seed = nbGr_SR,
seed_weight = poids_sd,
germ = nbGr_germ,
sown = nbGr_semis)
data_flower <- read.table(file_path,head=T) |>
mutate(ttt=as.factor(case_when(poll_treat==1~"low",
poll_treat==2~"medium",
TRUE~"high"))) |>
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high"))) |>
rename(nb_ab = nbAv,
nb_ov = nbOv,
nb_seed = nbGr_SR,
seed_weight = poids_sd,
germ = nbGr_germ,
sown = nbGr_semis)
# proportion non-aborted
data_proxy_ab <- data_flower %>%
filter(!(is.na(nb_ab)|is.na(nb_seed))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_ab_sum_ab=sum(nbAv,na.rm=T),
nb_seed_sum_ab=sum(nbGr_SR,na.rm=T))
# proportion non-aborted
data_proxy_ab <- data_flower %>%
filter(!(is.na(nb_ab)|is.na(nb_seed))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_ab_sum_ab=sum(nb_ab,na.rm=T),
nb_seed_sum_ab=sum(nb_seed,na.rm=T))
# proportion germinated
data_proxy_germ <- data_flower %>%
filter(!(is.na(nb_sown)|is.na(nb_germ))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_sown_sum_germ=sum(nb_sown,na.rm=T),
nb_germ_sum_germ=sum(nb_germ,na.rm=T))
data_flower <- read.table(file_path,head=T) |>
mutate(ttt=as.factor(case_when(poll_treat==1~"low",
poll_treat==2~"medium",
TRUE~"high"))) |>
mutate(ttt=forcats::fct_relevel(ttt, c("low","medium","high"))) |>
rename(nb_ab = nbAv,
nb_ov = nbOv,
nb_seed = nbGr_SR,
seed_weight = poids_sd,
nb_germ = nbGr_germ,
nb_sown = nbGr_semis)
# proportion germinated
data_proxy_germ <- data_flower %>%
filter(!(is.na(nb_sown)|is.na(nb_germ))) %>%
group_by(ID_full,session,ttt) %>%
summarise(nb_sown_sum_germ=sum(nb_sown,na.rm=T),
nb_germ_sum_germ=sum(nb_germ,na.rm=T))
# proportion germinated
data_proxy_weight <- data_flower %>%
group_by(ID_full,session,ttt) %>%
summarise(mean_seed_weight=mean(mean_seed,na.rm=T))
# proportion germinated
data_proxy_weight <- data_flower %>%
group_by(ID_full,session,ttt) %>%
summarise(mean_seed_weight=mean(seed_weight,na.rm=T))
data_proxy_id <- data_proxy_ab |>
full_join(data_proxy_ss) |>
full_join(data_proxy_germ) |>
full_join(data_proxy_weight) |>
ungroup() |>
mutate_all(~ifelse(is.nan(.), NA, .)) |> # for id without seed weight
filter(if_any(4:10, ~ !is.na(.))) # remove id without data
data_proxy_id
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
file_path_obs = "data/data_ABPOLL_ID_level_detflo.txt"
file_path_gen = "data/fix10_paternities_ABPOLL.txt"
# couples with observed visits only (carry-over 10)
obs_clean <- read.table(file_path_obs,head=T) |>
filter(!session %in% c("5.FA1","5.MO1"))  |>
select(session,ID_full_foc,ID_full_part,id_flow_part,export_nb_visit_co10) |>
filter(ID_full_foc != ID_full_part)  |>
filter(!(is.na(export_nb_visit_co10)|export_nb_visit_co10==0)) |>
mutate(couple_obs = paste0(ID_full_foc,"_",id_flow_part)) |>
rename(id = ID_full_part,
id_flow = id_flow_part)
library(tidyverse)
# couples with observed visits only (carry-over 10)
obs_clean <- read.table(file_path_obs,head=T) |>
filter(!session %in% c("5.FA1","5.MO1"))  |>
select(session,ID_full_foc,ID_full_part,id_flow_part,export_nb_visit_co10) |>
filter(ID_full_foc != ID_full_part)  |>
filter(!(is.na(export_nb_visit_co10)|export_nb_visit_co10==0)) |>
mutate(couple_obs = paste0(ID_full_foc,"_",id_flow_part)) |>
rename(id = ID_full_part,
id_flow = id_flow_part)
# filtering only observed contact
gen_clean <- read.table(file_path_gen,head=T) |>
filter(known_id != candidate_id) |>
mutate(offspring_id = stringr::str_remove(offspring_id, pattern = "_run3"),
offspring_id = stringr::str_remove(offspring_id, pattern = "a"),
offspring_id = stringr::str_remove(offspring_id, pattern = "b")) |>
mutate(flower_id = sub("_[^_]+$", "", offspring_id)) |>
mutate(couple_gen = paste0(candidate_id,"_",flower_id)) |>
filter(couple_gen %in% obs_only$couple_obs)  |>
rename(id = known_id,
id_flow = flower_id)
# filtering only observed contact
gen_clean <- read.table(file_path_gen,head=T) |>
filter(known_id != candidate_id) |>
mutate(offspring_id = stringr::str_remove(offspring_id, pattern = "_run3"),
offspring_id = stringr::str_remove(offspring_id, pattern = "a"),
offspring_id = stringr::str_remove(offspring_id, pattern = "b")) |>
mutate(flower_id = sub("_[^_]+$", "", offspring_id)) |>
mutate(couple_gen = paste0(candidate_id,"_",flower_id)) |>
filter(couple_gen %in% obs_clean$couple_obs)  |>
rename(id = known_id,
id_flow = flower_id)
q_obs_id <- obs_clean |>
group_by(id) %>%
summarise(
q_obs = q_index(import_nb_visit_co10),
.groups = "drop"
)
q_index <- function(x) {
n <- length(x)
N <- sum(x)
if (N <= 1) return(NA)  # to avoid dividing by zero
sum_xi <- sum(x * (x - 1))
I_d <- (sum_xi) / (N * (N - 1))
return(I_d)
}
q_obs_id <- obs_clean |>
group_by(id) %>%
summarise(
q_obs = q_index(import_nb_visit_co10),
.groups = "drop"
)
obs_clean
q_obs_id <- obs_clean |>
group_by(id) %>%
summarise(
q_obs = q_index(export_nb_visit_co10),
.groups = "drop"
)
q_obs_id
q_gen_id <- gen_clean |>
group_by(id,candidate_id) |>
summarise(genot_couple = n()) |>
group_by(id) |>
summarise(
q_gen = q_index(genot_couple),
.groups = "drop"
)
q_obs_flower <- obs_clean |>
group_by(id, id_flow) %>%
summarise(
q_obs = q_index(export_nb_visit_co10),
.groups = "drop"
)
q_gen_flower <- gen_clean |>
group_by(id, id_flow, candidate_id) |>
summarise(genot_couple = n()) |>
group_by(id, id_flow) |>
summarise(
q_gen = q_index(genot_couple),
.groups = "drop"
)
q_obs_flower
targets:tar_load(data_flower)
targets::tar_load(data_flower)
data_flower$pl
head(data_flower)
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(oms_gms_id_flower)
oms_gms_flower <- oms_gms_id_flower$oms_gms_flower
oms_gms_id <- oms_gms_id_flower$oms_gms_id
targets::tar_load(data_proxy_id)
data_final_flower <- data_flower |>
select(ID_full, id_flow, session, ttt, nb_ab, nb_ov, nb_seed, seed_weight, nb_sown, nb_germ, pl) |>
left_join(oms_gms_flower)
data_final_flower
data_proxy_id
oms_gms_id
data_proxy_id
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(data_final'
targets::tar_load(data_final)
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(data_final)
data_final$data_final_flower
data_final$data_final_id
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
#' Project builder
## Install Dependencies (listed in DESCRIPTION) ----
remotes::install_deps(upgrade = "never")
## Run Project ----
targets::tar_make()
targets::tar_load(data_final)
data_final$data_final_id
data_final$data_final_flower
data_final_flower
data_final_flower <- data_final$data_final_flower
glmer(data = data_final_flower, pl ~ id + (1|session), family = "poisson")
lme4::glmer(data = data_final_flower, pl ~ id + (1|session), family = "poisson")
model <- lme4::glmer(data = data_final_flower, pl ~ id + ttt + (1|session), family = "poisson")
model <- lme4::glmer(data = data_final_flower, pl ~ 1 + (1 | id) + (1|session:id), family = "poisson")
model_id <- lme4::glmer(data = data_final_flower, pl ~ 1 + (1 | id) + (1|session:id), family = "poisson")
vc <- as.data.frame(VarCorr(model_id))
?VarrCorr
??VarCorr
vc <- as.data.frame(lme4::VarCorr(model_id))
vc
var_id <- vc[vc$grp == "id", "vcov"]
var_session <- vc[vc$grp == "session:id", "vcov"]
icc_id <- var_id / (var_id + var_session)
icc_id
model_id <- lme4::glmer(data = data_final_flower, pl ~ ttt + (1 | id) + (1|session:id), family = "poisson")
vc <- as.data.frame(lme4::VarCorr(model_id))
var_id <- vc[vc$grp == "id", "vcov"]
var_session <- vc[vc$grp == "session:id", "vcov"]
icc_id <- var_id / (var_id + var_session)
icc_id
model_id <- lme4::glmer(data = data_final_flower, pl ~ 1 + (1 | id) + (1|session), family = "poisson")
model_id <- lme4::glmer(data = data_final_flower, pl ~ 1 + (1 | id) + (1|session), family = "poisson")
vc <- as.data.frame(lme4::VarCorr(model_id))
var_id <- vc[vc$grp == "id", "vcov"]
var_session <- vc[vc$grp == "session", "vcov"]
icc_id <- var_id / (var_id + var_session)
icc_id
model_pl <- lme4::glmer(data = data_final_flower, pl ~ 1 + (1 |session:id) + (1|session), family = "poisson")
vc <- as.data.frame(lme4::VarCorr(model_pl))
var_id <- vc[vc$grp == "session:id", "vcov"]
var_session <- vc[vc$grp == "session", "vcov"]
icc_id <- var_id / (var_id + var_session)
icc_id
model_oms_q_flower <- lme4::glmer(data = data_final_flower, ratio_q ~ oms + pl * ttt + (1|session) + (1|session:id), family = "poisson")
warnings()
model_oms_q_flower <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + pl * ttt + (1|session) + (1|session:id))
Anova(model_oms_q_flower)
car::Anova(model_oms_q_flower)
?update
anova(model_oms_q_flower, update(model_oms_q_flower, . ~ . - oms))
model_oms_q_flower <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + pl * ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower, update(model_oms_q_flower, . ~ . - oms:ttt))
anova(update(model_oms_q_flower, . ~ . - oms), update(model_oms_q_flower, . ~ . - oms:ttt))
model_oms_q_flower <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + pl * ttt + (1|session) + (1|session:id))
car::Anova(model_oms_q_flower)
model_oms_q_flower_0 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + pl * ttt + (1|session) + (1|session:id))
model_oms_q_flower_1 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + pl * ttt + (1|session) + (1|session:id))
model_oms_q_flower_2 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + pl + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1)
anova(model_oms_q_flower_0, model_oms_q_flower_2) # sign oms * ttt
model_oms_q_flower_0 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + pl * ttt + (1|session) + (1|session:id))
model_oms_q_flower_1 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + pl * ttt + (1|session) + (1|session:id))
model_oms_q_flower_2 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms * ttt + pl + ttt + (1|session) + (1|session:id))
model_oms_q_flower_3 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_4 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_5 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + pl + (1|session) + (1|session:id))
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
anova(model_oms_q_flower_0, model_oms_q_flower_2) # ns pl *
anova(model_oms_q_flower_3, model_oms_q_flower_4) #
model_oms_q_flower_5 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + pl + (1|session) + (1|session:id))
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
anova(model_oms_q_flower_0, model_oms_q_flower_2) # ns pl * ttt
anova(model_oms_q_flower_3, model_oms_q_flower_4) # sign oms
anova(model_oms_q_flower_3, model_oms_q_flower_5) #
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
model_oms_q_flower_3 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_4 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_5 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + pl + (1|session) + (1|session:id))
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
anova(model_oms_q_flower_0, model_oms_q_flower_2) # ns pl * ttt
anova(model_oms_q_flower_3, model_oms_q_flower_4) # sign oms
anova(model_oms_q_flower_3, model_oms_q_flower_5) # marg sign ttt
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter(!is.na(pl)), ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
anova(model_oms_q_flower_0, model_oms_q_flower_2) # ns pl * ttt
anova(model_oms_q_flower_3, model_oms_q_flower_4) # sign oms
anova(model_oms_q_flower_3, model_oms_q_flower_5) # marg sign ttt
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
data_final_flower |> filter(!is.na(pl)
)
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter(!(is.na(pl)&is.na(oms)), ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter(!(is.na(pl)&is.na(oms))), ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
data_final_flower |> filter(!(is.na(pl)&is.na(oms)))
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter(!(is.na(pl)|is.na(oms))), ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
data_final_flower |> filter(!(is.na(pl)|is.na(oms)))
model_oms_q_flower_3 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_4 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_5 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + pl + (1|session) + (1|session:id))
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter(!(is.na(pl)|is.na(oms))), ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
anova(model_oms_q_flower_0, model_oms_q_flower_2) # ns pl * ttt
anova(model_oms_q_flower_3, model_oms_q_flower_4) # sign oms
anova(model_oms_q_flower_3, model_oms_q_flower_5) # marg sign ttt
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
model_oms_q_flower_3 <- lme4::lmer(data = data_final_flower |> filter(!(is.na(pl)|is.na(oms))), ratio_q ~ oms + ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_4 <- lme4::lmer(data = data_final_flower, ratio_q ~ ttt + pl + (1|session) + (1|session:id))
model_oms_q_flower_5 <- lme4::lmer(data = data_final_flower, ratio_q ~ oms + pl + (1|session) + (1|session:id))
model_oms_q_flower_6 <- lme4::lmer(data = data_final_flower |> filter(!(is.na(pl)|is.na(oms))), ratio_q ~ oms + ttt + (1|session) + (1|session:id))
anova(model_oms_q_flower_0, model_oms_q_flower_1) # sign oms * ttt
anova(model_oms_q_flower_0, model_oms_q_flower_2) # ns pl * ttt
anova(model_oms_q_flower_3, model_oms_q_flower_4) # sign oms
anova(model_oms_q_flower_3, model_oms_q_flower_5) # marg sign ttt
anova(model_oms_q_flower_3, model_oms_q_flower_6) #
